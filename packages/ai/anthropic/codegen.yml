# yaml-language-server: $schema=../../tools/ai-codegen/codegen.schema.json
spec:
  type: stainless-stats
  statsUrl: https://raw.githubusercontent.com/anthropics/anthropic-sdk-typescript/main/.stats.yml
output: src/Generated.ts
name: AnthropicClient
patches:
  # Remove string from Model schema - only keep literal model IDs
  - '[{"op":"remove","path":"/components/schemas/Model/anyOf/0"}]'
header: |
  /**
   * @since 1.0.0
   */
replacements:
  # Schema.Unknown doesn't work with Schema.toCodecJson (used by HttpClientResponse.schemaBodyJson)
  # Replace with Schema.Json which properly handles arbitrary JSON values
  - from: "Schema.Record(Schema.String, Schema.Unknown)"
    to: "Schema.Record(Schema.String, Schema.Json)"
  - from: "{ readonly [x: string]: unknown }"
    to: "{ readonly [x: string]: Schema.Json }"
  # Index signature in struct rest pattern
  - from: "readonly [x: string]: unknown"
    to: "readonly [x: string]: Schema.Json"
  # Remove problematic examples from schema annotations
  # CountMessageTokensResponse examples don't match required type structure
  - from: ', "examples": [{"input_tokens":2095}]'
    to: ""
  # MessageDeltaUsage examples don't match required type structure
  - from: ', "examples": [{"output_tokens":503}]'
    to: ""
  # Usage examples in Message don't match required type structure
  - from: ', "examples": [{"input_tokens":2095,"output_tokens":503}]'
    to: ""
  # Message-level examples have incomplete usage and missing fields
  - from: ', "examples": [{"content":[{"citations":null,"text":"Hi! My name is Claude.","type":"text"}],"id":"msg_013Zva2CMHLNnXjNJJKqJ2EF","model":"claude-sonnet-4-5-20250929","role":"assistant","stop_reason":"end_turn","stop_sequence":null,"type":"message","usage":{"input_tokens":2095,"output_tokens":503}}]'
    to: ""
  # Tool examples don't match union discriminant - remove them
  - from: ', "examples": [{"description":"Get the current weather in a given location","input_schema":{"properties":{"location":{"description":"The city and state, e.g. San Francisco, CA","type":"string"},"unit":{"description":"Unit for the output - one of (celsius, fahrenheit)","type":"string"}},"required":["location"],"type":"object"},"name":"get_weather"}]'
    to: ""
  # Make citations optional in ResponseTextBlock (API may omit this field)
  - from: "export type ResponseTextBlock = { readonly \"citations\":"
    to: "export type ResponseTextBlock = { readonly \"citations\"?:"
  - from: "export const ResponseTextBlock = Schema.Struct({ \"citations\": Schema.Union([Schema.Array(Schema.Union([ResponseCharLocationCitation, ResponsePageLocationCitation, ResponseContentBlockLocationCitation, ResponseWebSearchResultLocationCitation, ResponseSearchResultLocationCitation], { mode: \"oneOf\" })), Schema.Null]).annotate({ \"title\": \"Citations\", \"description\": \"Citations supporting the text block.\\n\\nThe type of citation returned will depend on the type of document being cited. Citing a PDF results in `page_location`, plain text results in `char_location`, and content document results in `content_block_location`.\", \"default\": null }), \"text\":"
    to: "export const ResponseTextBlock = Schema.Struct({ \"citations\": Schema.optionalKey(Schema.Union([Schema.Array(Schema.Union([ResponseCharLocationCitation, ResponsePageLocationCitation, ResponseContentBlockLocationCitation, ResponseWebSearchResultLocationCitation, ResponseSearchResultLocationCitation], { mode: \"oneOf\" })), Schema.Null]).annotate({ \"title\": \"Citations\", \"description\": \"Citations supporting the text block.\\n\\nThe type of citation returned will depend on the type of document being cited. Citing a PDF results in `page_location`, plain text results in `char_location`, and content document results in `content_block_location`.\", \"default\": null })), \"text\":"
  # Make citations optional in BetaResponseTextBlock (API may omit this field)
  - from: "export type BetaResponseTextBlock = { readonly \"citations\":"
    to: "export type BetaResponseTextBlock = { readonly \"citations\"?:"
  - from: "export const BetaResponseTextBlock = Schema.Struct({ \"citations\": Schema.Union([Schema.Array(Schema.Union([BetaResponseCharLocationCitation, BetaResponsePageLocationCitation, BetaResponseContentBlockLocationCitation, BetaResponseWebSearchResultLocationCitation, BetaResponseSearchResultLocationCitation], { mode: \"oneOf\" })), Schema.Null]).annotate({ \"title\": \"Citations\", \"description\": \"Citations supporting the text block.\\n\\nThe type of citation returned will depend on the type of document being cited. Citing a PDF results in `page_location`, plain text results in `char_location`, and content document results in `content_block_location`.\", \"default\": null }), \"text\":"
    to: "export const BetaResponseTextBlock = Schema.Struct({ \"citations\": Schema.optionalKey(Schema.Union([Schema.Array(Schema.Union([BetaResponseCharLocationCitation, BetaResponsePageLocationCitation, BetaResponseContentBlockLocationCitation, BetaResponseWebSearchResultLocationCitation, BetaResponseSearchResultLocationCitation], { mode: \"oneOf\" })), Schema.Null]).annotate({ \"title\": \"Citations\", \"description\": \"Citations supporting the text block.\\n\\nThe type of citation returned will depend on the type of document being cited. Citing a PDF results in `page_location`, plain text results in `char_location`, and content document results in `content_block_location`.\", \"default\": null })), \"text\":"
  # Make server_tool_use optional in usage (API may omit this field)
  - from: "readonly \"server_tool_use\": ServerToolUsage | null"
    to: "readonly \"server_tool_use\"?: ServerToolUsage | null"
  - from: "readonly \"server_tool_use\": BetaServerToolUsage | null"
    to: "readonly \"server_tool_use\"?: BetaServerToolUsage | null"
  - from: "\"server_tool_use\": Schema.Union([ServerToolUsage, Schema.Null]).annotate({ \"description\": \"The number of server tool requests.\", \"default\": null }),"
    to: "\"server_tool_use\": Schema.optionalKey(Schema.Union([ServerToolUsage, Schema.Null]).annotate({ \"description\": \"The number of server tool requests.\", \"default\": null })),"
  - from: "\"server_tool_use\": Schema.Union([BetaServerToolUsage, Schema.Null]).annotate({ \"description\": \"The number of server tool requests.\", \"default\": null }),"
    to: "\"server_tool_use\": Schema.optionalKey(Schema.Union([BetaServerToolUsage, Schema.Null]).annotate({ \"description\": \"The number of server tool requests.\", \"default\": null })),"
  # Without trailing comma (for last field in struct)
  - from: "\"server_tool_use\": Schema.Union([BetaServerToolUsage, Schema.Null]).annotate({ \"description\": \"The number of server tool requests.\", \"default\": null }) })"
    to: "\"server_tool_use\": Schema.optionalKey(Schema.Union([BetaServerToolUsage, Schema.Null]).annotate({ \"description\": \"The number of server tool requests.\", \"default\": null })) })"
  - from: "\"server_tool_use\": Schema.Union([ServerToolUsage, Schema.Null]).annotate({ \"description\": \"The number of server tool requests.\", \"default\": null }) })"
    to: "\"server_tool_use\": Schema.optionalKey(Schema.Union([ServerToolUsage, Schema.Null]).annotate({ \"description\": \"The number of server tool requests.\", \"default\": null })) })"
  # Make context_management and container optional in BetaMessage (API may omit these fields)
  - from: "readonly \"context_management\": BetaResponseContextManagement | null"
    to: "readonly \"context_management\"?: BetaResponseContextManagement | null"
  - from: "readonly \"container\": BetaContainer | null"
    to: "readonly \"container\"?: BetaContainer | null"
  - from: "\"context_management\": Schema.Union([BetaResponseContextManagement, Schema.Null]).annotate({ \"description\": \"Context management response.\\n\\nInformation about context management strategies applied during the request.\", \"default\": null }),"
    to: "\"context_management\": Schema.optionalKey(Schema.Union([BetaResponseContextManagement, Schema.Null]).annotate({ \"description\": \"Context management response.\\n\\nInformation about context management strategies applied during the request.\", \"default\": null })),"
  - from: "\"container\": Schema.Union([BetaContainer, Schema.Null]).annotate({ \"description\": \"Information about the container used in this request.\\n\\nThis will be non-null if a container tool (e.g. code execution) was used.\", \"default\": null })"
    to: "\"container\": Schema.optionalKey(Schema.Union([BetaContainer, Schema.Null]).annotate({ \"description\": \"Information about the container used in this request.\\n\\nThis will be non-null if a container tool (e.g. code execution) was used.\", \"default\": null }))"
  # Make context_management optional in BetaMessageDeltaEvent (API may omit this field)
  - from: "\"context_management\": Schema.Union([BetaResponseContextManagement, Schema.Null]).annotate({ \"description\": \"Information about context management strategies applied during the request\", \"default\": null }),"
    to: "\"context_management\": Schema.optionalKey(Schema.Union([BetaResponseContextManagement, Schema.Null]).annotate({ \"description\": \"Information about context management strategies applied during the request\", \"default\": null })),"